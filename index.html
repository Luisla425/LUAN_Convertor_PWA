<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Epic Converter - El conversor de monedas m√°s √©pico de Venezuela">
    <title>Epic Converter‚ö° | LUANSystem‚Ñ¢</title>
    
    <!-- PWA Meta Tags -->
    <meta name="theme-color" content="#1a1a2e">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <link rel="apple-touch-icon" href="icon-192.png">
    <link rel="manifest" href="manifest.json">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background: linear-gradient(135deg, #1a1a2e 0%, #16213e 100%);
            min-height: 100vh;
            color: #fff;
            padding: 20px;
            overflow-x: hidden;
        }

        .container {
            max-width: 600px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            margin-bottom: 30px;
            animation: fadeInDown 0.6s ease-out;
        }

        .logo {
            font-size: 3.5rem;
            margin-bottom: 10px;
            filter: drop-shadow(0 0 20px rgba(255, 215, 0, 0.3));
        }

        h1 {
            font-size: 2.5rem;
            background: linear-gradient(90deg, #ffd700, #ffed4e);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 5px;
            font-weight: bold;
        }

        .subtitle {
            color: #a8dadc;
            font-size: 1rem;
            font-style: italic;
        }

        .glass-card {
            background: rgba(255, 255, 255, 0.05);
            backdrop-filter: blur(10px);
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 25px;
            border: 1px solid rgba(255, 255, 255, 0.1);
            animation: fadeIn 0.8s ease-out;
        }

        .section-title {
            font-size: 1.4rem;
            margin-bottom: 20px;
            color: #ffd700;
        }

        .rates-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 15px;
            margin-bottom: 20px;
        }

        .rate-card {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 15px;
            text-align: center;
            transition: all 0.3s ease;
            border: 1px solid transparent;
        }

        .rate-card:hover {
            background: rgba(255, 255, 255, 0.1);
            border-color: rgba(255, 215, 0, 0.3);
            transform: translateY(-2px);
        }

        .rate-icon {
            font-size: 2.5rem;
            margin-bottom: 8px;
        }

        .rate-name {
            font-weight: 600;
            color: #ffd700;
            margin-bottom: 5px;
        }

        .rate-label {
            font-size: 0.75rem;
            color: #a8dadc;
            margin-bottom: 8px;
        }

        .rate-value {
            font-size: 1.3rem;
            font-weight: bold;
            color: #4ecca3;
        }

        .input-group {
            margin-bottom: 20px;
        }

        label {
            display: block;
            margin-bottom: 8px;
            color: #a8dadc;
            font-size: 0.9rem;
        }

        input, select {
            width: 100%;
            padding: 15px;
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            background: rgba(255, 255, 255, 0.08);
            color: #fff;
            font-size: 1.1rem;
            transition: all 0.3s ease;
        }

        input:focus, select:focus {
            outline: none;
            border-color: #ffd700;
            background: rgba(255, 255, 255, 0.12);
            box-shadow: 0 0 15px rgba(255, 215, 0, 0.2);
        }

        select option {
            background: #1a1a2e;
            color: #fff;
        }

        .result-display {
            background: linear-gradient(135deg, #4ecca3 0%, #3eb489 100%);
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            margin-top: 20px;
            box-shadow: 0 8px 20px rgba(78, 204, 163, 0.3);
        }

        .result-label {
            font-size: 0.9rem;
            margin-bottom: 5px;
            opacity: 0.9;
        }

        .result-value {
            font-size: 2rem;
            font-weight: bold;
        }

        /* Compra/Venta Section */
        .toggle-container {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .toggle-btn {
            flex: 1;
            padding: 12px;
            border-radius: 12px;
            border: 2px solid rgba(255, 215, 0, 0.3);
            background: rgba(255, 255, 255, 0.05);
            color: #fff;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .toggle-btn:hover {
            background: rgba(255, 215, 0, 0.1);
        }

        .toggle-btn.active {
            background: linear-gradient(135deg, #ffd700, #ffed4e);
            color: #1a1a2e;
            border-color: #ffd700;
        }

        .trade-result {
            background: linear-gradient(135deg, #ff6b6b 0%, #ee5a6f 100%);
            padding: 20px;
            border-radius: 15px;
            text-align: center;
            margin-top: 20px;
            box-shadow: 0 8px 20px rgba(255, 107, 107, 0.3);
        }

        .trade-result.buying {
            background: linear-gradient(135deg, #4ecdc4 0%, #44a08d 100%);
        }

        .update-info {
            text-align: center;
            color: #a8dadc;
            font-size: 0.85rem;
            margin-top: 20px;
        }

        .loading {
            text-align: center;
            padding: 40px;
            color: #ffd700;
        }

        .spinner {
            border: 3px solid rgba(255, 255, 255, 0.1);
            border-radius: 50%;
            border-top: 3px solid #ffd700;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 0 auto 15px;
        }

        .error {
            background: rgba(244, 67, 54, 0.1);
            color: #ff6b6b;
            padding: 15px;
            border-radius: 12px;
            border: 1px solid rgba(244, 67, 54, 0.3);
            margin-top: 15px;
            text-align: center;
        }

        .footer {
            text-align: center;
            margin-top: 40px;
            padding: 20px;
            color: #a8dadc;
            font-size: 0.9rem;
        }

        .brand {
            color: #ffd700;
            font-weight: 700;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        @keyframes fadeInDown {
            from {
                opacity: 0;
                transform: translateY(-20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        @media (max-width: 480px) {
            .logo {
                font-size: 2.5rem;
            }

            h1 {
                font-size: 1.8rem;
            }

            .rates-grid {
                grid-template-columns: 1fr;
            }

            .rate-value {
                font-size: 1.1rem;
            }

            .result-value {
                font-size: 1.5rem;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header class="header">
            <div class="logo">üí±</div>
            <h1>Epic Converter‚ö°</h1>
            <p class="subtitle">El conversor m√°s √©pico de Venezuela</p>
        </header>

        <div id="loading" class="loading">
            <div class="spinner"></div>
            <p>Cargando tasas del d√≠a...</p>
        </div>

        <div id="mainContent" style="display: none;">
            <!-- TASAS DEL D√çA -->
            <div class="glass-card">
                <h2 class="section-title">üìä Tasas del D√≠a</h2>
                
                <div class="rates-grid">
                    <div class="rate-card">
                        <div class="rate-icon">üí∂</div>
                        <div class="rate-name">EUR</div>
                        <div class="rate-label">Euro</div>
                        <div class="rate-value" id="eurRate">-</div>
                    </div>

                    <div class="rate-card">
                        <div class="rate-icon">üíµ</div>
                        <div class="rate-name">USD BCV</div>
                        <div class="rate-label">Oficial</div>
                        <div class="rate-value" id="bcvRate">-</div>
                    </div>

                    <div class="rate-card">
                        <div class="rate-icon">üí∞</div>
                        <div class="rate-name">Cambiar Saldo</div>
                        <div class="rate-label">Tasa Libre</div>
                        <div class="rate-value" id="cambiarRate">-</div>
                    </div>

                    <div class="rate-card">
                        <div class="rate-icon">‚Çø</div>
                        <div class="rate-name">USDT</div>
                        <div class="rate-label">Binance</div>
                        <div class="rate-value" id="binanceRate">-</div>
                    </div>
                </div>
            </div>

            <!-- CONVERSOR UNIVERSAL -->
            <div class="glass-card">
                <h2 class="section-title">üîÑ Conversor Universal</h2>
                
                <div class="input-group">
                    <label for="amount">Monto</label>
                    <input type="number" id="amount" placeholder="Ingresa el monto" step="0.01" min="0">
                </div>

                <div class="input-group">
                    <label for="fromCurrency">De</label>
                    <select id="fromCurrency">
                        <option value="VES">üáªüá™ Bol√≠vares (Bs)</option>
                        <option value="BCV">üíµ USD BCV (Oficial)</option>
                        <option value="CAMBIAR">üí∞ Cambiar Saldo</option>
                        <option value="BINANCE">‚Çø USDT Binance</option>
                        <option value="EUR">üí∂ Euro (EUR)</option>
                    </select>
                </div>

                <div class="input-group">
                    <label for="toCurrency">A</label>
                    <select id="toCurrency">
                        <option value="BCV">üíµ USD BCV (Oficial)</option>
                        <option value="VES">üáªüá™ Bol√≠vares (Bs)</option>
                        <option value="CAMBIAR">üí∞ Cambiar Saldo</option>
                        <option value="BINANCE">‚Çø USDT Binance</option>
                        <option value="EUR">üí∂ Euro (EUR)</option>
                    </select>
                </div>

                <div id="result" class="result-display" style="display: none;">
                    <div class="result-label">Resultado</div>
                    <div class="result-value" id="resultValue">0.00</div>
                </div>
            </div>

            <!-- COMPRA/VENTA -->
            <div class="glass-card">
                <h2 class="section-title">üí∞ Compra/Venta de D√≥lares</h2>
                <p style="color: #a8dadc; margin-bottom: 20px; font-size: 0.9rem;">
                    Calcula r√°pido cu√°nto pagas o recibes en una negociaci√≥n
                </p>

                <div class="toggle-container">
                    <button class="toggle-btn active" id="sellBtn" onclick="setTradeMode('sell')">
                        Vendo USD
                    </button>
                    <button class="toggle-btn" id="buyBtn" onclick="setTradeMode('buy')">
                        Compro USD
                    </button>
                </div>

                <div class="input-group">
                    <label for="tradeAmount">Cantidad de USD</label>
                    <input type="number" id="tradeAmount" placeholder="Ej: 100" step="0.01" min="0">
                </div>

                <div class="input-group">
                    <label for="tradeRate">Tasa acordada (Bs/$)</label>
                    <input type="number" id="tradeRate" placeholder="Ej: 395" step="0.01" min="0">
                </div>

                <div id="tradeResult" class="trade-result" style="display: none;">
                    <div class="result-label" id="tradeLabel">Recibir√°s</div>
                    <div class="result-value" id="tradeValue">Bs 0.00</div>
                </div>
            </div>

            <div class="update-info" id="updateInfo">
                √öltima actualizaci√≥n: Cargando...
            </div>
        </div>

        <footer class="footer">
            <p>
                Made with üî• by <span class="brand">Luis L√°rez - LUANSystem‚Ñ¢</span>
            </p>
            <p style="margin-top: 5px; font-size: 0.75rem; opacity: 0.7;">
                Tasas en tiempo real ‚Ä¢ Venezuela üáªüá™
            </p>
        </footer>
    </div>

    <script>
        let rates = {
            BCV: 0,      // USD Oficial
            CAMBIAR: 0,  // Paralelo (sin decir "paralelo")
            BINANCE: 0,  // USDT
            EUR: 0       // Euro
        };

        let lastUpdate = null;
        let tradeMode = 'sell'; // 'sell' o 'buy'

        // Cargar tasas al iniciar
        async function loadRates() {
            try {
                // 1. Cargar USD BCV y Cambiar Saldo desde ve.dolarapi.com
                const dolarResponse = await fetch('https://ve.dolarapi.com/v1/dolares');
                const dolarData = await dolarResponse.json();
                
                // Buscar oficial y paralelo
                const oficial = dolarData.find(d => d.fuente === 'oficial');
                const paralelo = dolarData.find(d => d.fuente === 'paralelo');
                
                rates.BCV = oficial ? parseFloat(oficial.promedio) : 0;
                rates.CAMBIAR = paralelo ? parseFloat(paralelo.promedio) : 0;

                // 2. Cargar EUR desde exchangerate-api
                const eurResponse = await fetch('https://api.exchangerate-api.com/v4/latest/EUR');
                const eurData = await eurResponse.json();
                // EUR a VES = EUR a USD √ó USD BCV
                const eurToUsd = eurData.rates.USD || 1.18;
                rates.EUR = rates.BCV * eurToUsd;

                // 3. Cargar Binance USDT/VES desde criptoya
                try {
                    const binanceResponse = await fetch('https://criptoya.com/api/binance/usdt/ves/0.1');
                    const binanceData = await binanceResponse.json();
                    rates.BINANCE = binanceData.totalAsk ? parseFloat(binanceData.totalAsk) : rates.CAMBIAR;
                } catch (e) {
                    // Fallback: usar tasa paralelo si Binance falla
                    rates.BINANCE = rates.CAMBIAR;
                }

                lastUpdate = new Date();
                updateDisplay();
                document.getElementById('loading').style.display = 'none';
                document.getElementById('mainContent').style.display = 'block';
            } catch (error) {
                console.error('Error cargando tasas:', error);
                document.getElementById('loading').innerHTML = `
                    <div class="error">
                        ‚ö†Ô∏è Error al cargar las tasas<br>
                        <small>Verifica tu conexi√≥n e intenta nuevamente</small>
                    </div>
                `;
            }
        }

        function updateDisplay() {
            document.getElementById('bcvRate').textContent = formatCurrency(rates.BCV, 'Bs');
            document.getElementById('cambiarRate').textContent = formatCurrency(rates.CAMBIAR, 'Bs');
            document.getElementById('binanceRate').textContent = formatCurrency(rates.BINANCE, 'Bs');
            document.getElementById('eurRate').textContent = formatCurrency(rates.EUR, 'Bs');
            
            if (lastUpdate) {
                const timeStr = lastUpdate.toLocaleTimeString('es-VE', { 
                    hour: '2-digit', 
                    minute: '2-digit' 
                });
                const dateStr = lastUpdate.toLocaleDateString('es-VE', { 
                    day: '2-digit', 
                    month: 'short',
                    year: 'numeric'
                });
                document.getElementById('updateInfo').textContent = 
                    `√öltima actualizaci√≥n: ${dateStr} a las ${timeStr}`;
            }
        }

        function formatCurrency(value, currency = '') {
            const formatted = new Intl.NumberFormat('es-VE', {
                minimumFractionDigits: 2,
                maximumFractionDigits: 2
            }).format(value);
            return currency ? `${currency} ${formatted}` : formatted;
        }

        function convert() {
            const amount = parseFloat(document.getElementById('amount').value);
            const fromCurrency = document.getElementById('fromCurrency').value;
            const toCurrency = document.getElementById('toCurrency').value;
            const resultDiv = document.getElementById('result');
            const resultValue = document.getElementById('resultValue');

            if (isNaN(amount) || amount <= 0) {
                resultDiv.style.display = 'none';
                return;
            }

            if (fromCurrency === toCurrency) {
                resultValue.textContent = formatCurrency(amount, getCurrencySymbol(toCurrency));
                resultDiv.style.display = 'block';
                return;
            }

            let result = 0;
            let amountInVES = 0;

            // Primero convertir todo a VES
            if (fromCurrency === 'VES') {
                amountInVES = amount;
            } else {
                amountInVES = amount * rates[fromCurrency];
            }

            // Luego convertir VES a la moneda destino
            if (toCurrency === 'VES') {
                result = amountInVES;
            } else {
                result = amountInVES / rates[toCurrency];
            }

            resultValue.textContent = formatCurrency(result, getCurrencySymbol(toCurrency));
            resultDiv.style.display = 'block';
        }

        function getCurrencySymbol(currency) {
            const symbols = {
                'VES': 'Bs',
                'BCV': '$',
                'CAMBIAR': '$',
                'BINANCE': 'USDT',
                'EUR': '‚Ç¨'
            };
            return symbols[currency] || '';
        }

        function setTradeMode(mode) {
            tradeMode = mode;
            
            // Actualizar botones
            if (mode === 'sell') {
                document.getElementById('sellBtn').classList.add('active');
                document.getElementById('buyBtn').classList.remove('active');
                document.getElementById('tradeResult').classList.remove('buying');
            } else {
                document.getElementById('buyBtn').classList.add('active');
                document.getElementById('sellBtn').classList.remove('active');
                document.getElementById('tradeResult').classList.add('buying');
            }
            
            // Recalcular si hay valores
            calculateTrade();
        }

        function calculateTrade() {
            const amount = parseFloat(document.getElementById('tradeAmount').value);
            const rate = parseFloat(document.getElementById('tradeRate').value);
            const resultDiv = document.getElementById('tradeResult');
            const resultValue = document.getElementById('tradeValue');
            const resultLabel = document.getElementById('tradeLabel');

            if (isNaN(amount) || isNaN(rate) || amount <= 0 || rate <= 0) {
                resultDiv.style.display = 'none';
                return;
            }

            const total = amount * rate;
            
            if (tradeMode === 'sell') {
                resultLabel.textContent = 'üí∏ Recibir√°s';
            } else {
                resultLabel.textContent = 'üí≥ Pagar√°s';
            }

            resultValue.textContent = formatCurrency(total, 'Bs');
            resultDiv.style.display = 'block';
        }

        // Event Listeners - Conversor
        document.getElementById('amount').addEventListener('input', convert);
        document.getElementById('fromCurrency').addEventListener('change', convert);
        document.getElementById('toCurrency').addEventListener('change', convert);

        // Event Listeners - Compra/Venta
        document.getElementById('tradeAmount').addEventListener('input', calculateTrade);
        document.getElementById('tradeRate').addEventListener('input', calculateTrade);

        // Cargar tasas al iniciar
        loadRates();

        // Actualizar tasas cada 5 minutos
        setInterval(loadRates, 5 * 60 * 1000);
    </script>
</body>
</html>